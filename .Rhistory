simulate_one_gen <- function(N_wm, N_sm, decay_rate_wm, decay_rate_sm, s_wm, s_sm, m_rate_wm, m_rate_sm) {
# draw offspring according to Poisson distribution
offsp_wd <- rpois(1, N_wm * (1-decay_rate_wm-s_wm))
offsp_wb <- rpois(1, N_wm * (1-decay_rate_wm+s_wm))
offsp_sd <- rpois(1, N_sm * (1-decay_rate_sm-s_sm))
offsp_wb <- rpois(1, N_sm * (1-decay_rate_sm+s_sm))
# draw new mutants according to Poisson distribution
mut_wd_to_wb <- rpois(1, offsp_wd * m_rate_wm)
mut_sd_to_sb <- rpois(1, offsp_sd * m_rate_sm)
# determine new population sizes of wild type and mutant
N_wd_new <- max(offsp_wd - mut_wd_to_wb, 0)
N_wb_new <-  offsp_wb + mut_wd_to_wb
N_sd_new <- max(offsp_sd - mut_sd_to_sb, 0)
N_sb_new <-  offsp_sb + mut_sd_to_sb
return(c(N_wd_new, N_wb_new, N_sd_new, N_sb_new))
}
# Test the function
print(simulate_one_gen(50,50,0.1,0.6,0.2,0.6,0.01,0.01))
simulate_one_gen <- function(N_wm, N_sm, decay_rate_wm, decay_rate_sm, s_wm, s_sm, m_rate_wm, m_rate_sm) {
# draw offspring according to Poisson distribution
offsp_wd <- rpois(1, N_wm * (1-decay_rate_wm-s_wm))
offsp_wb <- rpois(1, N_wm * (1-decay_rate_wm+s_wm))
offsp_sd <- rpois(1, N_sm * (1-decay_rate_sm-s_sm))
offsp_sb <- rpois(1, N_sm * (1-decay_rate_sm+s_sm))
# draw new mutants according to Poisson distribution
mut_wd_to_wb <- rpois(1, offsp_wd * m_rate_wm)
mut_sd_to_sb <- rpois(1, offsp_sd * m_rate_sm)
# determine new population sizes of wild type and mutant
N_wd_new <- max(offsp_wd - mut_wd_to_wb, 0)
N_wb_new <-  offsp_wb + mut_wd_to_wb
N_sd_new <- max(offsp_sd - mut_sd_to_sb, 0)
N_sb_new <-  offsp_sb + mut_sd_to_sb
return(c(N_wd_new, N_wb_new, N_sd_new, N_sb_new))
}
# Test the function
print(simulate_one_gen(50,50,0.1,0.6,0.2,0.6,0.01,0.01))
simulate_one_gen <- function(N_wm, N_sm, decay_rate_wm, decay_rate_sm, s_wm, s_sm, m_rate_wm, m_rate_sm) {
# draw offspring according to Poisson distribution
offsp_wd <- rpois(1, N_wm * (1-decay_rate_wm-s_wm))
offsp_wb <- rpois(1, N_wm * (1-decay_rate_wm+s_wm))
offsp_sd <- rpois(1, N_sm * (1-decay_rate_sm-s_sm))
offsp_sb <- rpois(1, N_sm * (1-decay_rate_sm+s_sm))
# draw new mutants according to Poisson distribution
mut_wd_to_wb <- rpois(1, offsp_wd * m_rate_wm)
mut_sd_to_sb <- rpois(1, offsp_sd * m_rate_sm)
# determine new population sizes of wild type and mutant
N_wd_new <- max(offsp_wd - mut_wd_to_wb, 0)
N_wb_new <-  offsp_wb + mut_wd_to_wb
N_sd_new <- max(offsp_sd - mut_sd_to_sb, 0)
N_sb_new <-  offsp_sb + mut_sd_to_sb
return(c(N_wd_new, N_wb_new, N_sd_new, N_sb_new))
}
# Test the function
print(simulate_one_gen(50,50,0.1,0.6,0.2,0.6,0.1,0.1))
simulate_one_gen <- function(N_wm, N_sm, decay_rate_wm, decay_rate_sm, s_wm, s_sm, m_rate_wm, m_rate_sm) {
# draw offspring according to Poisson distribution
offsp_wd <- rpois(1, N_wm * (1-decay_rate_wm-s_wm))
offsp_wb <- rpois(1, N_wm * (1-decay_rate_wm+s_wm))
offsp_sd <- rpois(1, N_sm * (1-decay_rate_sm-s_sm))
offsp_sb <- rpois(1, N_sm * (1-decay_rate_sm+s_sm))
# draw new mutants according to Poisson distribution
mut_wd_to_wb <- rpois(1, offsp_wd * m_rate_wm)
mut_sd_to_sb <- rpois(1, offsp_sd * m_rate_sm)
# determine new population sizes of wild type and mutant
N_wd_new <- max(offsp_wd - mut_wd_to_wb, 0)
N_wb_new <-  offsp_wb + mut_wd_to_wb
N_sd_new <- max(offsp_sd - mut_sd_to_sb, 0)
N_sb_new <-  offsp_sb + mut_sd_to_sb
return(c(N_wd_new, N_wb_new, N_sd_new, N_sb_new))
}
# Test the function
print(simulate_one_gen(50,50,0.1,0.6,0.2,0.6,0.5,0.5))
simulate_one_gen <- function(N_wm, N_sm, decay_rate_wm, decay_rate_sm, s_wm, s_sm, m_rate_wm, m_rate_sm) {
# draw offspring according to Poisson distribution
offsp_wd <- rpois(1, N_wm * (1-decay_rate_wm-s_wm))
offsp_wb <- rpois(1, N_wm * (1-decay_rate_wm+s_wm))
offsp_sd <- rpois(1, N_sm * (1-decay_rate_sm-s_sm))
offsp_sb <- rpois(1, N_sm * (1-decay_rate_sm+s_sm))
# draw new mutants according to Poisson distribution
mut_wd_to_wb <- rpois(1, offsp_wd * m_rate_wm)
mut_sd_to_sb <- rpois(1, offsp_sd * m_rate_sm)
# determine new population sizes of wild type and mutant
N_wd_new <- max(offsp_wd - mut_wd_to_wb, 0)
N_wb_new <-  offsp_wb + mut_wd_to_wb
N_sd_new <- max(offsp_sd - mut_sd_to_sb, 0)
N_sb_new <-  offsp_sb + mut_sd_to_sb
return(c(N_wd_new, N_wb_new, N_sd_new, N_sb_new))
}
# Test the function
print(simulate_one_gen(50,50,0.1,0.2,0.2,0.4,0.5,0.5))
simulate_one_gen <- function(N_wm, N_sm, decay_rate_wm, decay_rate_sm, s_wm, s_sm, m_rate_wm, m_rate_sm) {
# draw offspring according to Poisson distribution
offsp_wd <- rpois(1, N_wm * (1-decay_rate_wm-s_wm))
offsp_wb <- rpois(1, N_wm * (1-decay_rate_wm+s_wm))
offsp_sd <- rpois(1, N_sm * (1-decay_rate_sm-s_sm))
offsp_sb <- rpois(1, N_sm * (1-decay_rate_sm+s_sm))
# draw new mutants according to Poisson distribution
mut_wd_to_wb <- rpois(1, offsp_wd * m_rate_wm)
mut_sd_to_sb <- rpois(1, offsp_sd * m_rate_sm)
# determine new population sizes of wild type and mutant
N_wd_new <- max(offsp_wd - mut_wd_to_wb, 0)
N_wb_new <-  offsp_wb + mut_wd_to_wb
N_sd_new <- max(offsp_sd - mut_sd_to_sb, 0)
N_sb_new <-  offsp_sb + mut_sd_to_sb
return(c(N_wd_new, N_wb_new, N_sd_new, N_sb_new))
}
# Test the function
print(simulate_one_gen(50,50,0.1,0.4,0.2,0.5,0.5,0.5))
simulate_one_gen <- function(N_wm, N_sm, decay_rate_wm, decay_rate_sm, s_wm, s_sm, m_rate_wm, m_rate_sm) {
# draw offspring according to Poisson distribution
offsp_wd <- rpois(1, N_wm * (1-decay_rate_wm-s_wm))
offsp_wb <- rpois(1, N_wm * (1-decay_rate_wm+s_wm))
offsp_sd <- rpois(1, N_sm * (1-decay_rate_sm-s_sm))
offsp_sb <- rpois(1, N_sm * (1-decay_rate_sm+s_sm))
# draw new mutants according to Poisson distribution
mut_wd_to_wb <- rpois(1, offsp_wd * m_rate_wm)
mut_sd_to_sb <- rpois(1, offsp_sd * m_rate_sm)
# determine new population sizes of wild type and mutant
N_wd_new <- max(offsp_wd - mut_wd_to_wb, 0)
N_wb_new <-  offsp_wb + mut_wd_to_wb
N_sd_new <- max(offsp_sd - mut_sd_to_sb, 0)
N_sb_new <-  offsp_sb + mut_sd_to_sb
return(c(N_wd_new, N_wb_new, N_sd_new, N_sb_new))
}
# Test the function
print(simulate_one_gen(50,50,0.1,0.4,0.2,0.5,0.5,0.5))
simulate_one_gen <- function(N_wm, N_sm, decay_rate_wm, decay_rate_sm, s_wm, s_sm, m_rate_wm, m_rate_sm) {
# draw offspring according to Poisson distribution
offsp_wd <- rpois(1, N_wm * (1-decay_rate_wm-s_wm))
offsp_wb <- rpois(1, N_wm * (1-decay_rate_wm+s_wm))
offsp_sd <- rpois(1, N_sm * (1-decay_rate_sm-s_sm))
offsp_sb <- rpois(1, N_sm * (1-decay_rate_sm+s_sm))
# draw new mutants according to Poisson distribution
mut_wd_to_wb <- rpois(1, offsp_wd * m_rate_wm)
mut_sd_to_sb <- rpois(1, offsp_sd * m_rate_sm)
# determine new population sizes of wild type and mutant
N_wd_new <- max(offsp_wd - mut_wd_to_wb, 0)
N_wb_new <-  offsp_wb + mut_wd_to_wb
N_sd_new <- max(offsp_sd - mut_sd_to_sb, 0)
N_sb_new <-  offsp_sb + mut_sd_to_sb
return(c(N_wd_new, N_wb_new, N_sd_new, N_sb_new))
}
# Test the function
print(simulate_one_gen(50,50,0.1,0.4,0.2,0.5,0.5,0.5))
